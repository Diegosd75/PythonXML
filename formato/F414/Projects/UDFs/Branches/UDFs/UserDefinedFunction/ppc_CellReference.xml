<object stamp="ba415c5d-418e-4d15-b2ba-4cb6b7dcfa63_1630319118931" type="UserDefinedFunction" version="2.0">
    <property name="objectId" value="c683f240-66ab-48e2-b6a5-6958579d8c98" valueType="string"/>
    <property name="branchId" value="UDFs" valueType="string"/>
    <property name="name" value="ppc_CellReference" valueType="string"/>
    <property name="description" value="2021.02.14" valueType="string"/>
    <property name="arguments" valueType="table">
        <object type="UserDefinedFunction:argument" version="1.0">
            <property name="name" value="CR_object" valueType="string"/>
            <property name="description" value="" valueType="string"/>
        </object>
        <object type="UserDefinedFunction:argument" version="1.0">
            <property name="name" value="CR_value" valueType="string"/>
            <property name="description" value="" valueType="string"/>
        </object>
    </property>
    <property name="body" valueType="object">
        <object type="ASLExpression" version="1.0">
            <property name="expression" valueType="table">
                <object type="ASLExpression:part" version="1.0">
                    <property name="expression" value="&lt;!--&#xa;Copyright by AXIOM SL, Igor Kirilyuk&#xa;Version of 2021.02.14&#xa;Get cell reference&#xa;Input variables:&#xa;CR_object - &#xa;CR_value - &#xa;-->&#xa;var CR_ObjectIsJBook = true;&#xa;&lt;!-- For v10 Start -->&#xa;CR_ObjectIsJBook = &quot;com.axiomsl.free_form_report.util.ui.JBook_Fixed&quot;.equals(getClassName(CR_object));&#xa;&lt;!-- For v10 Finish -->&#x9;&#xa;&#xa;var CR_info = null;&#xa;&lt;if> CR_ObjectIsJBook&#xa;&#x9;&lt;then>&#xa;&#x9;&#x9;&lt;if> CR_value.indexOf(&quot;!&quot;) &amp;gt;= 0&#xa;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;CR_info = class(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;).resolveCellReference(CR_value, CR_object, true, -1);&#xa;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&#x9;&lt;else>&#xa;&#x9;&#x9;&#x9;&#x9;CR_info = if(CR_object.lookupDefinedName(CR_value) != null, try(class(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;).resolveCellReference(CR_object.getDefinedNameLocal(CR_value), CR_object, true, -1), var e2, null), null);&#xa;&#x9;&#x9;&#x9;&lt;/else>&#xa;&#x9;&#x9;&lt;/if>&#xa;&#x9;&lt;/then>&#xa;&#x9;&lt;else>&#xa;&lt;!-- For v10 Start -->&#xa;&#x9;&#x9;var CR_axiomVersion = AxiomVersion;&#xa;&#x9;&#x9;var CR_jbookModel = if((CR_axiomVersion.split(&quot;.&quot;).size() &amp;gt;= 2) and (CR_axiomVersion.split(&quot;.&quot;).get(1).matches(&quot;[0-9]*&quot;)) and (class(&quot;java.lang.Integer&quot;).parseInt(CR_axiomVersion.split(&quot;.&quot;).get(1)) &amp;gt; 1), CR_object.getBookModel(), CR_object.getJBook().getBookModel());&#xa;&#xa;&#x9;&#x9;&lt;if> CR_value.indexOf(&quot;!&quot;) &amp;gt;= 0&#xa;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;var CR_rangeRef = try(CR_jbookModel.formulaToRangeRef(CR_value), var ex, null);&#xa;&#x9;&#x9;&#x9;&#x9;&lt;if> CR_rangeRef != null&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CR_info = list();&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CR_info.add(CR_rangeRef.getSheet1().getSheetNumber());&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CR_info.add(CR_rangeRef.getRow1());&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CR_info.add(CR_rangeRef.getCol1());&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&#x9;&#x9;&lt;/if>&#xa;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&#x9;&lt;else>&#xa;&#x9;&#x9;&#x9;&#x9;var CR_nameModel = CR_object.getNamesModel();&#xa;&#x9;&#x9;&#x9;&#x9;var CR_cellSelection = CR_nameModel.getNameLocation(CR_value);&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;&lt;if> CR_cellSelection != null &#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var CR_referenceCell = if(CR_cellSelection != null, CR_cellSelection.getRanges().get(0), null);&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;if> CR_referenceCell != null&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;for> var indexSheet = 0 &lt;comma/> indexSheet &amp;lt; CR_jbookModel.getNumSheets() &lt;comma/> indexSheet++&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;do>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;if> CR_referenceCell.getSheet().getSheetName().equals(CR_jbookModel.getSheetName(indexSheet).trim())&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CR_info = list();&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CR_info.add(indexSheet);&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CR_info.add(CR_referenceCell.getFirstRow());&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CR_info.add(CR_referenceCell.getFirstColumn());&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;break;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/if>&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/do>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/for>&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/if>&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&#x9;&#x9;&lt;/if>&#x9;&#xa;&#x9;&#x9;&#x9;&lt;/else>&#xa;&#x9;&#x9;&lt;/if>&#x9;&#xa;&lt;!-- For v10 Finish -->&#x9;&#xa;&#x9;&lt;/else>&#xa;&lt;/if>&#x9;&#xa;; CR_info" valueType="string"/>
                </object>
            </property>
        </object>
    </property>
</object>