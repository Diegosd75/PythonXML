<object stamp="4652e70e-affc-42d0-8ffa-559aa83500de_1405089734115" type="UserDefinedFunction" version="2.0">
    <property name="objectId" value="45f309c7-e4c2-4e8f-b45e-f5b246c089a8" valueType="string"/>
    <property name="branchId" value="UDFs" valueType="string"/>
    <property name="name" value="UDF_ElecSubV_2" valueType="string"/>
    <property name="description" value="Building a vertical option ElecSub" valueType="string"/>
    <property name="arguments" valueType="table">
        <object type="UserDefinedFunction:argument" version="1.0">
            <property name="name" value="ESV_task" valueType="string"/>
            <property name="description" value="task" valueType="string"/>
        </object>
        <object type="UserDefinedFunction:argument" version="1.0">
            <property name="name" value="ESV_jbook" valueType="string"/>
            <property name="description" value="jbook" valueType="string"/>
        </object>
        <object type="UserDefinedFunction:argument" version="1.0">
            <property name="name" value="ESV_numberFormat" valueType="string"/>
            <property name="description" value="Number format for TEXT function. Like this &quot;00000&quot;" valueType="string"/>
        </object>
    </property>
    <property name="body" valueType="object">
        <object type="ASLExpression" version="1.0">
            <property name="expression" valueType="table">
                <object type="ASLExpression:part" version="1.0">
                    <property name="expression" value="&lt;!--&#xa;v2&#xa;¿¿¿¿¿¿¿¿¿¿¿¿¿ ¿¿¿¿¿¿¿¿¿¿ Electronic submition (¿¿¿¿¿¿¿¿¿¿¿¿ ¿¿¿¿¿¿¿ ¿¿¿¿¿¿¿¿¿¿)&#xa;¿¿¿¿¿¿¿ ¿¿¿¿¿¿¿¿¿¿:&#xa;ESV_task - task&#xa;ESV_jbook - jbook&#xa;ESV_numberFormat - Number format for TEXT function. Like this &quot;00000&quot;&#xa;-->&#xa;&#xa;trace(&quot;#!#!#! UDF_ElecSubV_2: Copyright by AXIOM SL, Igor Kirilyuk #!#!#!&quot;);&#xa;&lt;if> ESV_task != null and !((ESV_task.getState().toString()).equals(&quot;ACTIVE&quot;) or (ESV_task.getState().toString()).equals(&quot;WARNING&quot;))&#xa;&#x9;&lt;then>&#xa;&#x9;&#x9;var ESV_nameHeaderTable_Start = &quot;START_HEADER&quot;;&#xa;&#x9;&#x9;var ESV_infoHeaderTable_Start = if((ESV_jbook.lookupDefinedName(ESV_nameHeaderTable_Start) != null) and (function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_nameHeaderTable_Start), ESV_jbook, true, -1) != null), function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_nameHeaderTable_Start), ESV_jbook, true, -1), null);&#xa;&#xa;&#x9;&#x9;var ESV_nameHeaderTable_Stop = &quot;END_HEADER&quot;;&#xa;&#x9;&#x9;var ESV_infoHeaderTable_Stop = if((ESV_jbook.lookupDefinedName(ESV_nameHeaderTable_Stop) != null) and (function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_nameHeaderTable_Stop), ESV_jbook, true, -1) != null), function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_nameHeaderTable_Stop), ESV_jbook, true, -1), null);&#xa;&#xa;&#x9;&#x9;var ESV_nameDataCell_Start = &quot;START_BODY&quot;;&#xa;&#x9;&#x9;var ESV_infoDataCell_Start = if((ESV_jbook.lookupDefinedName(ESV_nameDataCell_Start) != null) and (function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_nameDataCell_Start), ESV_jbook, true, -1) != null), function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_nameDataCell_Start), ESV_jbook, true, -1), null);&#xa;&#xa;&#x9;&#x9;var ESV_nameDataCell_Stop = &quot;END_BODY&quot;;&#xa;&#x9;&#x9;var ESV_infoDataCell_Stop = if((ESV_jbook.lookupDefinedName(ESV_nameDataCell_Stop) != null) and (function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_nameDataCell_Stop), ESV_jbook, true, -1) != null), function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_nameDataCell_Stop), ESV_jbook, true, -1), null);&#xa;&#xa;&#x9;&#x9;var ESV_elecSubStartCell_Name = &quot;ELEC_SUB_STARTCELL&quot;;&#xa;&#x9;&#x9;var ESV_elecSubStartCell_Data = if((ESV_jbook.lookupDefinedName(ESV_elecSubStartCell_Name) != null) and (function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_elecSubStartCell_Name), ESV_jbook, true, -1) != null), function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_elecSubStartCell_Name), ESV_jbook, true, -1), null);&#xa;&#xa;&#x9;&#x9;var ESV_finalyTag_Name = &quot;FINAL_TAG&quot;;&#xa;&#x9;&#x9;var ESV_finalyTag_Data = if((ESV_jbook.lookupDefinedName(ESV_finalyTag_Name) != null) and (function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_finalyTag_Name), ESV_jbook, true, -1) != null), function(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;, &quot;resolveCellReference&quot;, ESV_jbook.getDefinedNameLocal(ESV_finalyTag_Name), ESV_jbook, true, -1), null);&#xa;&#x9;&#x9;&#xa;&#x9;&#x9;var ESV_indexRow = 1;&#xa;&#x9;&#x9;&#xa;&#x9;&#x9;var ESV_ESUBSheetNum = ESV_elecSubStartCell_Data.get(0);&#xa;&#x9;&#x9;var ESV_ESUBRowNum = 0;&#xa;&#x9;&#x9;var ESV_ESUBColNum = 0;&#xa;&#x9;&#x9;&#xa;&#x9;&#x9;ESV_jbook.setText(ESV_elecSubStartCell_Data.get(0), ESV_ESUBRowNum, ESV_ESUBColNum, &quot;0&quot;);&#xa;&#xa;&#x9;&#x9;&lt;if> (ESV_infoHeaderTable_Start != null) and (ESV_infoHeaderTable_Stop != null)&#xa;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;&lt;for> var indexRow = ESV_infoHeaderTable_Start.get(1) &lt;comma/> indexRow &amp;lt;= ESV_infoHeaderTable_Stop.get(1) &lt;comma/> indexRow++&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;do>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var ESV_RefString = class(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;).getCellRef(ESV_jbook.getSheetName(ESV_infoDataCell_Start.get(0)), indexRow, ESV_infoHeaderTable_Start.get(2), true);&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ESV_jbook.setFormula(ESV_ESUBSheetNum, ESV_ESUBRowNum + ESV_indexRow, ESV_ESUBColNum, &quot;TEXT(A&quot; + ESV_indexRow + &quot;+IF(&quot;&quot;&quot;&quot;=&quot; + ESV_RefString + &quot;,0,1),&quot;&quot;&quot; + ESV_numberFormat + &quot;&quot;&quot;)&quot;);&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ESV_jbook.setFormula(ESV_ESUBSheetNum, ESV_ESUBRowNum + ESV_indexRow, ESV_ESUBColNum + 1, &quot;IF(&quot;&quot;&quot;&quot;=&quot; + ESV_RefString + &quot;,&quot;&quot;&quot;&quot;,A&quot; + (ESV_indexRow + 1) + &quot;&amp;amp;&quot; + ESV_RefString + &quot;)&quot;);&#xa;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ESV_indexRow++;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/do>&#xa;&#x9;&#x9;&#x9;&#x9;&lt;/for>&#x9;&#xa;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&lt;/if>&#x9;&#xa;&#xa;&#x9;&#x9;&lt;if> (ESV_infoDataCell_Start != null) and (ESV_infoDataCell_Stop != null)&#xa;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;&lt;for> var indexCol = ESV_infoDataCell_Start.get(2) &lt;comma/> indexCol &amp;lt;= ESV_infoDataCell_Stop.get(2) &lt;comma/> indexCol++&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;do>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;for> var indexRow = ESV_infoDataCell_Start.get(1) &lt;comma/> indexRow &amp;lt;= ESV_infoDataCell_Stop.get(1) &lt;comma/> indexRow++&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;do>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var ESV_RefString = class(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;).getCellRef(ESV_jbook.getSheetName(ESV_infoDataCell_Start.get(0)), indexRow, indexCol, true);&#xa;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ESV_jbook.setFormula(ESV_ESUBSheetNum, ESV_ESUBRowNum + ESV_indexRow, ESV_ESUBColNum, &quot;TEXT(A&quot; + ESV_indexRow + &quot;+IF(&quot;&quot;&quot;&quot;=&quot; + ESV_RefString + &quot;,0,1),&quot;&quot;&quot; + ESV_numberFormat + &quot;&quot;&quot;)&quot;);&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ESV_jbook.setFormula(ESV_ESUBSheetNum, ESV_ESUBRowNum + ESV_indexRow, ESV_ESUBColNum + 1, &quot;IF(&quot;&quot;&quot;&quot;=&quot; + ESV_RefString + &quot;,&quot;&quot;&quot;&quot;,A&quot; + (ESV_indexRow + 1) + &quot;&amp;amp;&quot; + ESV_RefString + &quot;)&quot;);&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ESV_indexRow++;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/do>&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/for>&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/do>&#xa;&#x9;&#x9;&#x9;&#x9;&lt;/for>&#x9;&#xa;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&lt;/if>&#x9;&#x9;&#xa;&#x9;&#x9;&#xa;&#x9;&#x9;&lt;if> ESV_finalyTag_Data != null&#xa;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;var ESV_finalyTag = ESV_jbook.getText(ESV_finalyTag_Data.get(0), ESV_finalyTag_Data.get(1), ESV_finalyTag_Data.get(2));&#xa;&#x9;&#x9;&#x9;&#x9;ESV_jbook.setFormula(ESV_ESUBSheetNum, ESV_ESUBRowNum + ESV_indexRow, ESV_ESUBColNum, &quot;TEXT(A&quot; + ESV_indexRow + &quot;+1,&quot;&quot;&quot; + ESV_numberFormat + &quot;&quot;&quot;)&quot;);&#xa;&#x9;&#x9;&#x9;&#x9;ESV_jbook.setFormula(ESV_ESUBSheetNum, ESV_ESUBRowNum + ESV_indexRow, ESV_ESUBColNum + 1, &quot;A&quot; + (ESV_indexRow + 1) + &quot;&amp;amp;&quot; + ESV_finalyTag);&#xa;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&lt;/if>&#xa;&#xa;&#x9;&#x9;&lt;if> (ESV_infoHeaderTable_Start != null)&#xa;&#x9;&#x9;&#x9;&lt;then>&#xa;&#x9;&#x9;&#x9;&#x9;var ESV_RefString = class(&quot;com.axiomsl.free_form_report.setup.ReportDataSet&quot;).getCellRef(ESV_jbook.getSheetName(ESV_ESUBSheetNum), ESV_ESUBRowNum + ESV_indexRow, ESV_ESUBColNum, true);&#xa;&#x9;&#x9;&#x9;&#x9;ESV_jbook.setFormula(ESV_ESUBSheetNum, ESV_ESUBRowNum + 1, ESV_ESUBColNum + 1, &quot;A&quot; + (ESV_ESUBRowNum + 2) + &quot;&amp;amp;&quot;&quot;&quot; + ESV_jbook.getText(ESV_infoHeaderTable_Start.get(0), ESV_infoHeaderTable_Start.get(1), ESV_infoHeaderTable_Start.get(2)).replace(&quot;ROWCOUNT&quot;, &quot;&quot;&quot;&amp;amp;&quot; + ESV_RefString + &quot;&amp;amp;&quot;&quot;&quot;) + &quot;&quot;&quot;&quot;);&#xa;&#x9;&#x9;&#x9;&lt;/then>&#xa;&#x9;&#x9;&lt;/if>&#xa;&#xa;&#x9;&lt;/then>&#xa;&lt;/if>&#x9;&#xa;trace(&quot;#!#!#! UDF_ElecSubV_2: Stoped #!#!#!&quot;);" valueType="string"/>
                </object>
            </property>
        </object>
    </property>
</object>